2026-02-02 13:21:57,841 - INFO - Inicializando Playwright...
2026-02-02 13:21:59,595 - INFO - Janela maximizada via Windows API (ctypes).
2026-02-02 13:21:59,596 - INFO - Navegando para: https://out-prd.diagnosticosdobrasil.com.br/Portal/Login
2026-02-02 13:22:03,528 - INFO - Aguardando carregamento da Home...
2026-02-02 13:22:12,159 - WARNING - Menu lateral não ficou visível. Forçando navegação direta...
2026-02-02 13:22:16,877 - INFO - Página de pacientes acessada.
2026-02-02 13:22:16,878 - INFO - Iniciando ajuste atemporal do calendário (retroagindo 4 dias)...
2026-02-02 13:22:16,878 - INFO - Alvo dinâmico (4 dias atrás): Janeiro 29, 2026
2026-02-02 13:22:20,479 - WARNING - Calendário não abriu com ArrowDown. Tentando clique no ícone...
2026-02-02 13:22:22,039 - INFO - Elemento de dia encontrado: Janeiro 29, 2026. Clicando...
2026-02-02 13:22:23,136 - INFO - Data 'DE' ajustada para HOJE com sucesso.
2026-02-02 13:22:23,136 - INFO - Aguardando 5 segundos...
2026-02-02 13:22:28,137 - INFO - Selecionando filtro de Status: Completo
2026-02-02 13:22:28,176 - INFO - Aguardando opção 'Completo'...
2026-02-02 13:22:29,262 - INFO - Filtro 'Completo' aplicado com sucesso.
2026-02-02 13:22:29,262 - INFO - Aguardando 5 segundos...
2026-02-02 13:22:34,264 - INFO - Iniciando Passo 7: Pesquisa e Download do XML...
2026-02-02 13:22:34,264 - INFO - Clicando no botão 'Pesquisar' (#Btn_Pesquisar)...
2026-02-02 13:22:34,370 - INFO - Aguardando carregamento (networkidle)...
2026-02-02 13:22:34,371 - INFO - Aguardando renderização da tabela de resultados...
2026-02-02 13:22:34,385 - INFO - Tabela de resultados encontrada.
2026-02-02 13:22:34,400 - INFO - Encontrados 50 registros na tabela.
2026-02-02 13:22:34,484 - INFO - Checkbox VSÍVEL encontrado: #Checkbox3
2026-02-02 13:22:36,498 - WARNING - Erro ao validar checkbox #Checkbox3: Page.evaluate: TypeError: Cannot read properties of null (reading 'click')
    at eval (eval at evaluate (:290:30), <anonymous>:1:37)
    at eval (<anonymous>)
    at UtilityScript.evaluate (<anonymous>:290:30)
    at UtilityScript.<anonymous> (<anonymous>:1:44)
2026-02-02 13:22:36,522 - INFO - Checkbox VSÍVEL encontrado: .OSFillParent input[type='checkbox']
2026-02-02 13:22:37,290 - INFO - Checkbox CONFIRMADO como marcado: .OSFillParent input[type='checkbox']
2026-02-02 13:22:37,291 - INFO - Checkbox acionado. Iniciando processo de download...
2026-02-02 13:22:37,291 - INFO - Tentativa 1: Clicando em #BtnResultadoXML...
2026-02-02 13:23:07,309 - WARNING - Tentativa 1 falhou: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-02 13:23:07,310 - INFO - Tentativa 2: Buscando botão por texto 'Resultado XML'...
2026-02-02 13:23:37,324 - WARNING - Tentativa 2 falhou: Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-02 13:23:37,326 - INFO - Tentativa 3: Buscando Menu de Ações (SVG) na primeira linha...
2026-02-02 13:23:37,375 - INFO - Menu aberto. Buscando opção 'XML'...
2026-02-02 13:24:37,407 - WARNING - Tentativa 3 falhou: Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("text=XML")

2026-02-02 13:24:37,408 - ERROR - TODAS as tentativas de download falharam.
2026-02-02 13:24:37,408 - INFO - Processo encerrado.
