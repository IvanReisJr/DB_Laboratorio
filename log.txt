2026-02-19 12:13:02,429 - INFO - Inicializando Playwright...
2026-02-19 12:13:13,153 - INFO - Janela maximizada via Windows API (ctypes).
2026-02-19 12:13:13,155 - INFO - Navegando para: https://out-prd.diagnosticosdobrasil.com.br/Portal/Login
2026-02-19 12:13:17,145 - INFO - Aguardando carregamento da Home...
2026-02-19 12:13:26,178 - WARNING - Menu lateral não ficou visível. Forçando navegação direta...
2026-02-19 12:13:30,233 - INFO - Página de pacientes acessada.
2026-02-19 12:13:30,233 - INFO - Iniciando ajuste atemporal do calendário (HOJE)...
2026-02-19 12:13:30,233 - INFO - Alvo dinâmico (4 dias atrás): Fevereiro 19, 2026
2026-02-19 12:13:33,849 - WARNING - Calendário não abriu com ArrowDown. Tentando clique no ícone...
2026-02-19 12:13:35,405 - INFO - Elemento de dia encontrado: Fevereiro 19, 2026. Clicando...
2026-02-19 12:13:36,497 - INFO - Data 'DE' ajustada para HOJE com sucesso.
2026-02-19 12:13:36,498 - INFO - Aguardando 5 segundos...
2026-02-19 12:13:41,500 - INFO - Selecionando filtro de Status: Completo
2026-02-19 12:13:41,544 - INFO - Aguardando opção 'Completo'...
2026-02-19 12:13:42,628 - INFO - Filtro 'Completo' aplicado com sucesso.
2026-02-19 12:13:42,628 - INFO - Aguardando 5 segundos...
2026-02-19 12:13:47,635 - INFO - Iniciando Passo 7: Pesquisa e Download do XML...
2026-02-19 12:13:47,635 - INFO - Clicando no botão 'Pesquisar'...
2026-02-19 12:13:47,784 - INFO - Checkbox VISÍVEL encontrado: #Checkbox3
2026-02-19 12:14:18,494 - WARNING - Erro ao validar checkbox #Checkbox3: Locator.is_checked: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#Checkbox3").first

2026-02-19 12:14:18,514 - INFO - Checkbox VISÍVEL encontrado: .OSFillParent input[type='checkbox']
2026-02-19 12:14:19,048 - INFO - Checkbox CONFIRMADO como marcado: .OSFillParent input[type='checkbox']
2026-02-19 12:14:19,048 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:14:49,061 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:14:49,062 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:15:19,073 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:15:19,074 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:15:19,081 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:15:19,084 - WARNING - Tentativa 1/3 falhou em '_download_xml_with_retry': Exception: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.. Tentando novamente em 2.00s...
2026-02-19 12:15:21,089 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:15:51,101 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:15:51,101 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:16:21,115 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:16:21,115 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:16:21,121 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:16:21,132 - WARNING - Tentativa 2/3 falhou em '_download_xml_with_retry': Exception: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.. Tentando novamente em 4.00s...
2026-02-19 12:16:25,144 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:16:55,153 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:16:55,154 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:17:25,180 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:17:25,182 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:17:25,197 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:17:25,197 - ERROR - Todas as 3 tentativas falharam em '_download_xml_with_retry'. Erro final: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:17:25,204 - ERROR - Erro fatal no processo de download/separação: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:17:25,418 - CRITICAL - Falha na automação: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:17:25,655 - INFO - Processo encerrado.
