2026-02-19 12:34:29,472 - INFO - Inicializando Playwright...
2026-02-19 12:34:31,301 - INFO - Janela maximizada via Windows API (ctypes).
2026-02-19 12:34:31,301 - INFO - Navegando para: https://out-prd.diagnosticosdobrasil.com.br/Portal/Login
2026-02-19 12:34:35,200 - INFO - Aguardando carregamento da Home...
2026-02-19 12:34:44,005 - WARNING - Menu lateral não ficou visível. Forçando navegação direta...
2026-02-19 12:34:48,670 - INFO - Página de pacientes acessada.
2026-02-19 12:34:48,670 - INFO - Iniciando ajuste atemporal do calendário (HOJE)...
2026-02-19 12:34:48,670 - INFO - Alvo dinâmico (4 dias atrás): Fevereiro 19, 2026
2026-02-19 12:34:52,320 - WARNING - Calendário não abriu com ArrowDown. Tentando clique no ícone...
2026-02-19 12:34:53,873 - INFO - Elemento de dia encontrado: Fevereiro 19, 2026. Clicando...
2026-02-19 12:34:54,957 - INFO - Data 'DE' ajustada para HOJE com sucesso.
2026-02-19 12:34:54,958 - INFO - Aguardando 5 segundos...
2026-02-19 12:34:59,963 - INFO - Selecionando filtro de Status: Completo
2026-02-19 12:35:00,000 - INFO - Aguardando opção 'Completo'...
2026-02-19 12:35:01,118 - INFO - Filtro 'Completo' aplicado com sucesso.
2026-02-19 12:35:01,119 - INFO - Aguardando 5 segundos...
2026-02-19 12:35:06,121 - INFO - Iniciando Passo 7: Pesquisa e Download do XML...
2026-02-19 12:35:06,121 - INFO - Clicando no botão 'Pesquisar'...
2026-02-19 12:35:06,270 - INFO - Checkbox VISÍVEL encontrado: #Checkbox3
2026-02-19 12:35:08,286 - WARNING - Erro ao validar checkbox #Checkbox3: Page.evaluate: TypeError: Cannot read properties of null (reading 'click')
    at eval (eval at evaluate (:290:30), <anonymous>:1:37)
    at eval (<anonymous>)
    at UtilityScript.evaluate (<anonymous>:290:30)
    at UtilityScript.<anonymous> (<anonymous>:1:44)
2026-02-19 12:35:08,315 - INFO - Checkbox VISÍVEL encontrado: .OSFillParent input[type='checkbox']
2026-02-19 12:35:08,865 - INFO - Checkbox CONFIRMADO como marcado: .OSFillParent input[type='checkbox']
2026-02-19 12:35:08,866 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:35:38,879 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:35:38,881 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:36:08,901 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:36:08,901 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:36:08,908 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:36:08,916 - WARNING - Tentativa 1/3 falhou em '_download_xml_with_retry': Exception: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.. Tentando novamente em 2.00s...
2026-02-19 12:36:10,922 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:36:40,935 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:36:40,935 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:37:10,953 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:37:10,955 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:37:10,968 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:37:10,969 - WARNING - Tentativa 2/3 falhou em '_download_xml_with_retry': Exception: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.. Tentando novamente em 4.00s...
2026-02-19 12:37:14,989 - INFO - Tentando download via: ID #BtnResultadoXML
2026-02-19 12:37:44,995 - WARNING - Falha na estratégia 'ID #BtnResultadoXML': Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-19 12:37:44,995 - INFO - Tentando download via: Texto 'Resultado XML'
2026-02-19 12:38:15,026 - WARNING - Falha na estratégia 'Texto 'Resultado XML'': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-19 12:38:15,027 - INFO - Tentando download via: Menu de Ações
2026-02-19 12:38:15,048 - WARNING - Falha na estratégia 'Menu de Ações': Botão de menu não visível.
2026-02-19 12:38:15,051 - ERROR - Todas as 3 tentativas falharam em '_download_xml_with_retry'. Erro final: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:38:15,053 - ERROR - Erro fatal no processo de download/separação: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:38:15,219 - CRITICAL - Falha na automação: Todas as estratégias de download falharam: ID #BtnResultadoXML: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")
; Texto 'Resultado XML': Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")
; Menu de Ações: Botão de menu não visível.
2026-02-19 12:38:15,526 - INFO - Processo encerrado.
