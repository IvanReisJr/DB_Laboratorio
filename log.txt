2026-02-03 11:36:08,102 - INFO - === INICIANDO TENTATIVA 1/3 ===
2026-02-03 11:36:08,103 - INFO - Inicializando Playwright...
2026-02-03 11:36:09,924 - INFO - Janela maximizada via Windows API (ctypes).
2026-02-03 11:36:09,925 - INFO - Navegando para: https://out-prd.diagnosticosdobrasil.com.br/Portal/Login
2026-02-03 11:36:14,032 - INFO - Aguardando carregamento da Home...
2026-02-03 11:36:22,894 - WARNING - Menu lateral não ficou visível. Forçando navegação direta...
2026-02-03 11:36:28,115 - INFO - Página de pacientes acessada.
2026-02-03 11:36:28,116 - INFO - Iniciando ajuste atemporal do calendário (retroagindo 4 dias)...
2026-02-03 11:36:28,116 - INFO - Alvo dinâmico (4 dias atrás): Janeiro 30, 2026
2026-02-03 11:36:31,707 - WARNING - Calendário não abriu com ArrowDown. Tentando clique no ícone...
2026-02-03 11:36:33,265 - INFO - Elemento de dia encontrado: Janeiro 30, 2026. Clicando...
2026-02-03 11:36:34,349 - INFO - Data 'DE' ajustada para HOJE com sucesso.
2026-02-03 11:36:34,349 - INFO - Aguardando 5 segundos...
2026-02-03 11:36:39,350 - INFO - Selecionando filtro de Status: Completo
2026-02-03 11:36:39,392 - INFO - Aguardando opção 'Completo'...
2026-02-03 11:36:40,479 - INFO - Filtro 'Completo' aplicado com sucesso.
2026-02-03 11:36:40,480 - INFO - Aguardando 5 segundos...
2026-02-03 11:36:45,481 - INFO - Iniciando Passo 7: Pesquisa e Download do XML...
2026-02-03 11:36:45,482 - INFO - Clicando no botão 'Pesquisar' (#Btn_Pesquisar)...
2026-02-03 11:36:45,594 - INFO - Aguardando carregamento (networkidle)...
2026-02-03 11:36:45,595 - INFO - Aguardando renderização da tabela de resultados...
2026-02-03 11:36:45,609 - INFO - Tabela de resultados encontrada.
2026-02-03 11:36:45,625 - INFO - Encontrados 50 registros na tabela.
2026-02-03 11:36:45,635 - INFO - Checkbox VSÍVEL encontrado: #Checkbox3
2026-02-03 11:36:46,364 - WARNING - Clicou em #Checkbox3 mas status não mudou. Forçando JS com eventos...
2026-02-03 11:36:46,880 - INFO - Checkbox marcado via JS (com eventos).
2026-02-03 11:36:46,880 - INFO - Checkbox acionado. Iniciando processo de download...
2026-02-03 11:36:46,880 - INFO - Tentativa 1: Clicando em #BtnResultadoXML...
2026-02-03 11:37:16,888 - WARNING - Tentativa 1 falhou: Page.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("#BtnResultadoXML")

2026-02-03 11:37:16,888 - INFO - Tentativa 2: Buscando botão por texto 'Resultado XML'...
2026-02-03 11:37:46,894 - WARNING - Tentativa 2 falhou: Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for get_by_role("button", name="Resultado XML")

2026-02-03 11:37:46,896 - INFO - Tentativa 3: Buscando Menu de Ações (SVG) na primeira linha...
2026-02-03 11:37:46,966 - INFO - Menu aberto. Buscando opção 'XML'...
2026-02-03 11:38:46,991 - WARNING - Tentativa 3 falhou: Locator.click: Timeout 30000ms exceeded.
Call log:
  - waiting for locator("text=XML")

2026-02-03 11:38:46,991 - ERROR - TODAS as tentativas de download falharam.
2026-02-03 11:38:46,991 - CRITICAL - Falha na automação: Não foi possível iniciar o download após todas as tentativas.
2026-02-03 11:38:47,376 - INFO - Processo encerrado.
2026-02-03 11:38:47,376 - WARNING - === FALHA NA TENTATIVA 1 ===
2026-02-03 11:38:47,376 - INFO - Aguardando 10 segundos antes da próxima tentativa...
2026-02-03 11:38:57,377 - INFO - === INICIANDO TENTATIVA 2/3 ===
2026-02-03 11:38:57,377 - INFO - Inicializando Playwright...
2026-02-03 11:38:59,103 - INFO - Janela maximizada via Windows API (ctypes).
2026-02-03 11:38:59,103 - INFO - Navegando para: https://out-prd.diagnosticosdobrasil.com.br/Portal/Login
2026-02-03 11:39:03,110 - INFO - Aguardando carregamento da Home...
2026-02-03 11:39:13,041 - WARNING - Menu lateral não ficou visível. Forçando navegação direta...
2026-02-03 11:39:19,025 - INFO - Página de pacientes acessada.
2026-02-03 11:39:19,025 - INFO - Iniciando ajuste atemporal do calendário (retroagindo 4 dias)...
2026-02-03 11:39:19,025 - INFO - Alvo dinâmico (4 dias atrás): Janeiro 30, 2026
2026-02-03 11:39:22,638 - WARNING - Calendário não abriu com ArrowDown. Tentando clique no ícone...
2026-02-03 11:39:24,204 - INFO - Elemento de dia encontrado: Janeiro 30, 2026. Clicando...
2026-02-03 11:39:25,293 - INFO - Data 'DE' ajustada para HOJE com sucesso.
2026-02-03 11:39:25,293 - INFO - Aguardando 5 segundos...
2026-02-03 11:39:30,294 - INFO - Selecionando filtro de Status: Completo
2026-02-03 11:39:30,336 - INFO - Aguardando opção 'Completo'...
2026-02-03 11:39:31,421 - INFO - Filtro 'Completo' aplicado com sucesso.
2026-02-03 11:39:31,422 - INFO - Aguardando 5 segundos...
2026-02-03 11:39:36,423 - INFO - Iniciando Passo 7: Pesquisa e Download do XML...
2026-02-03 11:39:36,423 - INFO - Clicando no botão 'Pesquisar' (#Btn_Pesquisar)...
2026-02-03 11:39:36,529 - INFO - Aguardando carregamento (networkidle)...
2026-02-03 11:39:36,530 - INFO - Aguardando renderização da tabela de resultados...
2026-02-03 11:39:36,630 - INFO - Tabela de resultados encontrada.
2026-02-03 11:39:36,655 - INFO - Encontrados 50 registros na tabela.
2026-02-03 11:39:36,664 - INFO - Checkbox VSÍVEL encontrado: #Checkbox3
2026-02-03 11:39:37,702 - INFO - Checkbox CONFIRMADO como marcado: #Checkbox3
2026-02-03 11:39:37,702 - INFO - Checkbox acionado. Iniciando processo de download...
2026-02-03 11:39:37,702 - INFO - Tentativa 1: Clicando em #BtnResultadoXML...
2026-02-03 11:39:38,636 - INFO - Download iniciado via #BtnResultadoXML.
2026-02-03 11:39:38,778 - INFO - Arquivo baixado temporariamente em: C:\Users\pvplima\AppData\Local\Temp\playwright-artifacts-mgnVo0\2328ce93-7d50-4488-8404-05936e4eb787
2026-02-03 11:39:38,796 - INFO - Download concluído: C:\Pietro\Projetos\DB_Laboratorio\202602\lote_exames_20260203_113938.xml
2026-02-03 11:39:38,796 - INFO - Validando arquivo baixado: C:\Pietro\Projetos\DB_Laboratorio\202602\lote_exames_20260203_113938.xml...
2026-02-03 11:39:38,796 - INFO - Arquivo validado com sucesso (6170 bytes): lote_exames_20260203_113938.xml
2026-02-03 11:39:38,796 - INFO - Arquivo XML validado com sucesso.
2026-02-03 11:39:38,796 - INFO - Iniciando separação automática do lote...
2026-02-03 11:39:38,797 - INFO - Inicializando cliente Tasy para enriquecimento de dados...
2026-02-03 11:39:38,894 - INFO - Oracle Client (Thick Mode) inicializado em: C:\Pietro\Projetos\DB_Laboratorio\utils\instantclient_23_6
2026-02-03 11:39:38,895 - INFO - Histórico carregado com 6 atendimentos processados.
2026-02-03 11:39:38,916 - INFO - Buscando dados do paciente para prescrição: 6791908...
2026-02-03 11:39:38,985 - INFO - Dados do Paciente (Tasy): NELINA PAULA PUZZINE | CPF: 25047876691
2026-02-03 11:39:38,985 - INFO - Ignorando duplicado: 6791908
2026-02-03 11:39:38,985 - INFO - Buscando dados do paciente para prescrição: 6791911...
2026-02-03 11:39:39,044 - INFO - Dados do Paciente (Tasy): MARIA LINA ATALIBA DE CASTRO | CPF: 05998945719
2026-02-03 11:39:39,044 - INFO - Ignorando duplicado: 6791911
2026-02-03 11:39:39,044 - INFO - Buscando dados do paciente para prescrição: 6790505...
2026-02-03 11:39:39,119 - INFO - Dados do Paciente (Tasy): DARIO RICARDO DA SILVA NAVARES | CPF: 05485637728
2026-02-03 11:39:39,119 - INFO - Ignorando duplicado: 6790505
2026-02-03 11:39:39,119 - INFO - Buscando dados do paciente para prescrição: 6793859...
2026-02-03 11:39:39,194 - INFO - Dados do Paciente (Tasy): EDSON FRANCISCO DOS SANTOS | CPF: 31943519749
2026-02-03 11:39:39,194 - INFO - Ignorando duplicado: 6793859
2026-02-03 11:39:39,194 - INFO - Sucesso: 0 novos arquivos individuais criados.
2026-02-03 11:39:39,194 - INFO - Separação concluída.
2026-02-03 11:39:39,196 - INFO - Arquivo pai movido para backup: C:\Pietro\Projetos\DB_Laboratorio\2026\lote_exames_20260203_113938.xml
2026-02-03 11:39:39,499 - INFO - Processo encerrado.
2026-02-03 11:39:39,499 - INFO - === SUCESSO NA TENTATIVA 2 ===
